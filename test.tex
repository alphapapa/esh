\documentclass{article}

\usepackage{xcolor}

\usepackage{fontspec}
\usepackage[normalem]{ulem}

\newfontfamily{\Symbola}[Mapping=tex-ansi]{Symbola monospacified for Ubuntu Mono}
\newfontfamily{\UbuntuMonoCode}[Mapping=tex-ansi]{Ubuntu Mono}

\DeclareTextFontCommand{\SpecialChar}{\Symbola}

\newenvironment{HighlightWithEmacs}[1][]{%
  \setlength{\parindent}{0pt}\UbuntuMonoCode
}{%
  \par
}

\usepackage{fullpage}

\begin{document}

\section*{Coq Code}
\begin{HighlightWithEmacs}[coq-mode]
Class FacadeWrapper (WrappingType WrappedType: Type) :=
  { wrap: WrappedType -> WrappingType;
    wrap_inj: forall v v', wrap v = wrap v' -> v = v' }.

Inductive NameTag av T :=
| NTNone : NameTag av T
| NTSome (key1 key2: string) (H: FacadeWrapper (Value av) T) : NameTag av T.

Arguments NTNone {av T}.
Arguments NTSome {av T} key {H}.

Definition NameTagAsStringOption {av T} (nt: NameTag av T) :=
  match nt with
  | NTNone => None
  | NTSome key H => Some key
  end.

Inductive Telescope av : Type :=
| Nil : Telescope av
| Cons : forall T (key: NameTag av T)
           (val: Comp T)
           (tail: T -> Telescope av),
    Telescope av.
\end{HighlightWithEmacs}

\section*{C code:}
\begin{HighlightWithEmacs}[c-mode]
static void
x_update_menu_appearance (struct frame *f)
{
  struct x_display_info *dpyinfo = FRAME_DISPLAY_INFO (f);
  XrmDatabase rdb;

  if (dpyinfo
      && (rdb = XrmGetDatabase (FRAME_X_DISPLAY (f)),
      rdb != NULL))
    {
      char line[512];
      char *buf = line;
      ptrdiff_t bufsize = sizeof line;
      Lisp_Object lface = lface_from_face_name (f, Qmenu, true);
      struct face *face = FACE_FROM_ID (f, MENU_FACE_ID);
      const char *myname = SSDATA (Vx_resource_name);
      bool changed_p = false;
#ifdef USE_MOTIF
      const char *popup_path = "popup_menu";
#else
      const char *popup_path = "menu.popup";
#endif
\end{HighlightWithEmacs}
\end{document}